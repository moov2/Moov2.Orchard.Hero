/*
** NOTE: This file is generated by Gulp and should not be edited directly!
** Any changes made directly to this file will be overwritten next time its asset group is processed by Gulp.
*/

(function () {
    var CONTENT_TYPE_IMAGE = 'Image';

    var $openMediaBtn = $('.js-open-media-library'),
        $textArea = $('#Hero_Text');

    var addListeners = function () {
        $openMediaBtn.on('click', openMediaPicker);
    };

    /**
     * Opens media picker, content editor can select a media from library, which
     * is then used to generate HTML.
     */
    var openMediaPicker = function () {
        var adminIndex = location.href.toLowerCase().indexOf('/admin/'),
            cachedScrollPosition = 0;

        if (adminIndex === -1) {
            return false;
        }

        $.colorbox({
            href: location.href.substr(0, adminIndex) + '/Admin/Orchard.MediaLibrary?dialog=true',
            iframe: true,
            reposition: true,
            width: '90%',
            height: '90%',
            onLoad: function () {
                cachedScrollPosition = $('body').scrollTop();
                // hide the scrollbars from the main window
                $('html, body').css('overflow', 'hidden');
            },
            onClosed: function () {
                $('html, body').css('overflow', '');
                $('body').scrollTop(cachedScrollPosition);

                setHtml($.colorbox.selectedData);
            }
        });

        return false;
    };

    /**
     * Returns HTML for a single image.
     */
    var renderSingleImage = function (image) {
        return '<div class="hero">\n\t<div class="hero__content">\n\t\t<img src="' + image.resource + '" alt="' + image.alternateText + '" />\n\t</div>\n</div>';
    };

    /**
     * Uses selected media to set HTML.
     */
    var setHtml = function (media) {
        if (!media || media.length === 0) {
            return;
        }

        var html = '';

        if (media.length === 1 && media[0].contentType === CONTENT_TYPE_IMAGE) {
            html = renderSingleImage(media[0]);
        }

        $textArea.val(html).trigger('change');
    };

    addListeners();
})();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm9yY2hhcmQuaGVyby5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQUFMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJvcmNoYXJkLmhlcm8uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIENPTlRFTlRfVFlQRV9JTUFHRSA9ICdJbWFnZSc7XHJcblxyXG4gICAgdmFyICRvcGVuTWVkaWFCdG4gPSAkKCcuanMtb3Blbi1tZWRpYS1saWJyYXJ5JyksXHJcbiAgICAgICAgJHRleHRBcmVhID0gJCgnI0hlcm9fVGV4dCcpO1xyXG5cclxuICAgIHZhciBhZGRMaXN0ZW5lcnMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgJG9wZW5NZWRpYUJ0bi5vbignY2xpY2snLCBvcGVuTWVkaWFQaWNrZXIpO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIE9wZW5zIG1lZGlhIHBpY2tlciwgY29udGVudCBlZGl0b3IgY2FuIHNlbGVjdCBhIG1lZGlhIGZyb20gbGlicmFyeSwgd2hpY2hcclxuICAgICAqIGlzIHRoZW4gdXNlZCB0byBnZW5lcmF0ZSBIVE1MLlxyXG4gICAgICovXHJcbiAgICB2YXIgb3Blbk1lZGlhUGlja2VyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBhZG1pbkluZGV4ID0gbG9jYXRpb24uaHJlZi50b0xvd2VyQ2FzZSgpLmluZGV4T2YoJy9hZG1pbi8nKSxcclxuICAgICAgICAgICAgY2FjaGVkU2Nyb2xsUG9zaXRpb24gPSAwO1xyXG5cclxuICAgICAgICBpZiAoYWRtaW5JbmRleCA9PT0gLTEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJC5jb2xvcmJveCh7XHJcbiAgICAgICAgICAgIGhyZWY6IGxvY2F0aW9uLmhyZWYuc3Vic3RyKDAsIGFkbWluSW5kZXgpICsgJy9BZG1pbi9PcmNoYXJkLk1lZGlhTGlicmFyeT9kaWFsb2c9dHJ1ZScsXHJcbiAgICAgICAgICAgIGlmcmFtZTogdHJ1ZSxcclxuICAgICAgICAgICAgcmVwb3NpdGlvbjogdHJ1ZSxcclxuICAgICAgICAgICAgd2lkdGg6ICc5MCUnLFxyXG4gICAgICAgICAgICBoZWlnaHQ6ICc5MCUnLFxyXG4gICAgICAgICAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGNhY2hlZFNjcm9sbFBvc2l0aW9uID0gJCgnYm9keScpLnNjcm9sbFRvcCgpO1xyXG4gICAgICAgICAgICAgICAgLy8gaGlkZSB0aGUgc2Nyb2xsYmFycyBmcm9tIHRoZSBtYWluIHdpbmRvd1xyXG4gICAgICAgICAgICAgICAgJCgnaHRtbCwgYm9keScpLmNzcygnb3ZlcmZsb3cnLCAnaGlkZGVuJyk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG9uQ2xvc2VkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAkKCdodG1sLCBib2R5JykuY3NzKCdvdmVyZmxvdycsICcnKTtcclxuICAgICAgICAgICAgICAgICQoJ2JvZHknKS5zY3JvbGxUb3AoY2FjaGVkU2Nyb2xsUG9zaXRpb24pO1xyXG5cclxuICAgICAgICAgICAgICAgIHNldEh0bWwoJC5jb2xvcmJveC5zZWxlY3RlZERhdGEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIEhUTUwgZm9yIGEgc2luZ2xlIGltYWdlLlxyXG4gICAgICovXHJcbiAgICB2YXIgcmVuZGVyU2luZ2xlSW1hZ2UgPSBmdW5jdGlvbiAoaW1hZ2UpIHtcclxuICAgICAgICByZXR1cm4gJzxkaXYgY2xhc3M9XCJoZXJvXCI+XFxuXFx0PGRpdiBjbGFzcz1cImhlcm9fX2NvbnRlbnRcIj5cXG5cXHRcXHQ8aW1nIHNyYz1cIicgKyBpbWFnZS5yZXNvdXJjZSArICdcIiBhbHQ9XCInICsgaW1hZ2UuYWx0ZXJuYXRlVGV4dCArICdcIiAvPlxcblxcdDwvZGl2PlxcbjwvZGl2Pic7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogVXNlcyBzZWxlY3RlZCBtZWRpYSB0byBzZXQgSFRNTC5cclxuICAgICAqL1xyXG4gICAgdmFyIHNldEh0bWwgPSBmdW5jdGlvbiAobWVkaWEpIHtcclxuICAgICAgICBpZiAoIW1lZGlhIHx8IG1lZGlhLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgaHRtbCA9ICcnO1xyXG5cclxuICAgICAgICBpZiAobWVkaWEubGVuZ3RoID09PSAxICYmIG1lZGlhWzBdLmNvbnRlbnRUeXBlID09PSBDT05URU5UX1RZUEVfSU1BR0UpIHtcclxuICAgICAgICAgICAgaHRtbCA9IHJlbmRlclNpbmdsZUltYWdlKG1lZGlhWzBdKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICR0ZXh0QXJlYS52YWwoaHRtbCkudHJpZ2dlcignY2hhbmdlJyk7XHJcbiAgICB9O1xyXG5cclxuICAgIGFkZExpc3RlbmVycygpO1xyXG59KSgpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
